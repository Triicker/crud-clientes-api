<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Clientes - Versão HTML</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="auth-styles.css">
    <link rel="stylesheet" href="edit-modal-styles.css">
    <link rel="stylesheet" href="bulk-send-styles.css">
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header com autenticação -->
        <header class="header">
            <!-- User Header -->
            <div id="userHeader" class="user-header" style="display: none;">
                <div class="user-info">
                    <div class="user-avatar">
                        <i data-lucide="user" class="avatar-icon"></i>
                    </div>
                    <div class="user-details">
                        <span class="user-name" id="userName">Usuário</span>
                        <span class="user-role" id="userRole">Cargo</span>
                    </div>
                </div>
                <div class="user-actions">
                    <button id="userMenuButton" class="user-menu-button">
                        <i data-lucide="settings" class="menu-icon"></i>
                    </button>
                    <button id="logoutButton" class="logout-button">
                        <i data-lucide="log-out" class="logout-icon"></i>
                        <span>Sair</span>
                    </button>
                </div>
                <!-- Menu dropdown do usuário -->
                <div id="userMenu" class="user-menu" style="display: none;">
                    <div class="menu-item" id="userProfile">
                        <i data-lucide="user" class="menu-item-icon"></i>
                        <span>Meu Perfil</span>
                    </div>
                    <div class="menu-item" id="userStats">
                        <i data-lucide="bar-chart-3" class="menu-item-icon"></i>
                        <span>Estatísticas</span>
                    </div>
                    <div class="menu-divider"></div>
                    <div class="menu-item" id="logoutFromMenu">
                        <i data-lucide="log-out" class="menu-item-icon"></i>
                        <span>Sair do Sistema</span>
                    </div>
                </div>
            </div>

            <div class="title-section">
                <!-- Logo da marca -->
                <img 
                    src="https://midiasave-5c064.web.app/img-game/etica-branco.png" 
                    alt="Ética" 
                    class="header-logo"
                    loading="lazy"
                />
                <h1 class="title">Sistema de Gerenciamento de Clientes</h1>
                <div class="system-status" id="systemStatus">
                    <span class="status-indicator online"></span>
                    <span class="status-text"></span>
                </div>
            </div>
        </header>

        <!-- Search Bar -->
        <section class="search-section">
            <div class="search-container">
                <div class="search-input-wrapper">
                    <i data-lucide="search" class="search-icon"></i>
                    <input 
                        type="text" 
                        id="searchInput" 
                        class="search-input"
                        placeholder="Buscar por nome, cidade, CNPJ, telefone..."
                        autocomplete="off"
                    >
                    <button id="clearSearch" class="clear-button" style="display: none;">
                        <i data-lucide="x" class="clear-icon"></i>
                    </button>
                </div>
                
                <div class="filters">
                    <select id="stateFilter" class="filter-select">
                        <option value="">Carregando estados...</option>
                    </select>
                    
                    <select id="cityFilter" class="filter-select">
                        <option value="">Todas as Cidades</option>
                    </select>
                    
                    <select id="microregionFilter" class="filter-select">
                        <option value="">Todas as Microrregiões</option>
                    </select>
                    
                    <select id="typeFilter" class="filter-select">
                        <option value="">Todos os Tipos</option>
                        <option value="network">Rede de Ensino</option>
                        <option value="school">Escola</option>
                    </select>
                    
                    <button id="applyFilters" class="apply-button">
                        <i data-lucide="filter" class="filter-icon"></i>
                        Aplicar Filtros
                    </button>
                    
                    <button id="resetFilters" class="reset-button">
                        <i data-lucide="refresh-cw" class="reset-icon"></i>
                        Limpar Filtros
                    </button>
                </div>
            </div>
            
            <!-- Action Bar with Add Client Button -->
            <div class="action-bar">
                <div class="results-info">
                    <span id="resultsCount">Carregando...</span>
                    <span id="totalCount"></span>
                </div>
                <div style="display: flex; gap: 0.75rem;">
                    <button id="searchContractsButton" class="btn-add-client" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        <i data-lucide="search"></i>
                        <span>Pesquisar Contratos</span>
                    </button>
                    <button id="addClientButton" class="btn-add-client">
                        <i data-lucide="plus-circle"></i>
                        <span>Incluir Cliente</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Loading State -->
        <div id="loadingState" class="loading-state">
            <div class="loading-spinner"></div>
            <p>Carregando dados dos clientes...</p>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state" style="display: none;">
            <div class="empty-icon">
                <i data-lucide="search-x"></i>
            </div>
            <h3>Nenhum cliente encontrado</h3>
            <p>Tente ajustar os filtros ou termos de busca</p>
        </div>

        <!-- Client Table -->
        <section class="table-section" id="tableSection" style="display: none;">
            <!-- Botão de Novo Envio -->
            <div class="bulk-actions-container">
                <button id="bulkSendButton" class="bulk-send-button">
                    <i data-lucide="send"></i>
                    <span>+ Novo Envio</span>
                </button>
            </div>

            <div class="table-container">
                <table class="client-table" id="clientTable">
                    <thead>
                        <tr class="table-header">
                            <th class="th-client" scope="col">
                                <button class="sort-button" data-column="name">
                                    Cliente
                                    <i data-lucide="chevron-up-down" class="sort-icon"></i>
                                </button>
                            </th>
                            <th class="th-type" scope="col">
                                <button class="sort-button" data-column="type">
                                    Tipo
                                    <i data-lucide="chevron-up-down" class="sort-icon"></i>
                                </button>
                            </th>
                            <th class="th-phone" scope="col">
                                <button class="sort-button" data-column="phone">
                                    Telefone
                                    <i data-lucide="chevron-up-down" class="sort-icon"></i>
                                </button>
                            </th>
                            <th class="th-cnpj" scope="col">
                                <button class="sort-button" data-column="cnpj">
                                    CNPJ
                                    <i data-lucide="chevron-up-down" class="sort-icon"></i>
                                </button>
                            </th>
                            <th class="th-city" scope="col">
                                <button class="sort-button" data-column="city">
                                    Cidade
                                    <i data-lucide="chevron-up-down" class="sort-icon"></i>
                                </button>
                            </th>
                            <th class="th-state" scope="col">
                                <button class="sort-button" data-column="state">
                                    UF
                                    <i data-lucide="chevron-up-down" class="sort-icon"></i>
                                </button>
                            </th>
                            <th class="th-actions" scope="col">Ações</th>
                            <th class="th-checkbox checkbox-cell" scope="col">
                                <span 
                                    class="checkbox-legend"
                                    title="Selecione múltiplos clientes marcando as caixas; use este checkbox para marcar/desmarcar todos desta página."
                                >
                                    Todos
                                </span>
                                <input 
                                    type="checkbox" 
                                    id="selectAllCheckbox" 
                                    class="select-all-checkbox" 
                                    title="Selecionar todos os clientes desta página" 
                                    aria-label="Selecionar todos os clientes desta página"
                                >
                            </th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Dynamic content will be inserted here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Pagination -->
        <section class="pagination-section" id="paginationSection" style="display: none;">
            <div class="pagination-info">
                <span id="paginationInfo">Mostrando 0 de 0 registros</span>
            </div>
            
            <div class="pagination-controls">
                <button id="firstPage" class="pagination-button" disabled>
                    <i data-lucide="chevrons-left"></i>
                    Primeiro
                </button>
                <button id="prevPage" class="pagination-button" disabled>
                    <i data-lucide="chevron-left"></i>
                    Anterior
                </button>
                
                <div class="page-numbers" id="pageNumbers">
                    <!-- Dynamic page numbers will be inserted here -->
                </div>
                
                <button id="nextPage" class="pagination-button" disabled>
                    Próximo
                    <i data-lucide="chevron-right"></i>
                </button>
                <button id="lastPage" class="pagination-button" disabled>
                    Último
                    <i data-lucide="chevrons-right"></i>
                </button>
            </div>
            
            <div class="per-page-selector">
                <label for="perPageSelect">Por página:</label>
                <select id="perPageSelect" class="per-page-select">
                    <option value="10">10</option>
                    <option value="25" selected>25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
            </div>
        </section>
    </div>

    <!-- Client Detail Modal -->
    <div id="clientModal" class="modal" style="display: none;">
        <div class="modal-backdrop" id="modalBackdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Detalhes do Cliente</h2>
                <button id="closeModal" class="close-button">
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <div class="modal-body" id="modalBody">
                <!-- Dynamic content will be inserted here -->
            </div>
            
            <div class="modal-footer">
                <button id="editClient" class="action-button edit-button">
                    <i data-lucide="edit"></i>
                    Editar
                </button>
                <button id="deleteClient" class="action-button delete-button">
                    <i data-lucide="trash-2"></i>
                    Excluir
                </button>
                <button id="cancelModal" class="action-button cancel-button">
                    Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- Client Edit Modal -->
    <div id="editModal" class="modal" style="display: none;">
        <div class="modal-backdrop" id="editModalBackdrop" style="display:none;"></div>
        <div class="modal-content edit-modal-content" style="display:none;">
            <div class="modal-header">
                <h2 id="editModalTitle">Editar Cliente</h2>
                <button id="closeEditModal" class="close-button">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body edit-modal-body" id="editModalBody" style="display:none;">
                <form id="editClientForm" class="edit-form">
                    <!-- Informações Básicas -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="user" class="section-icon"></i>
                            Informações Básicas
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="editName">Nome da Instituição *</label>
                                <input type="text" id="editName" name="name" required class="form-input">
                            </div>
                            
                            <div class="form-group">
                                <label for="editType">Tipo de Instituição *</label>
                                <select id="editType" name="type" required class="form-select">
                                    <option value="">Selecione o tipo</option>
                                    <option value="network">Rede de Ensino</option>
                                    <option value="school">Escola Particular</option>
                                    <option value="public">Escola Pública</option>
                                    <option value="university">Universidade</option>
                                    <option value="course">Curso Técnico</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editCnpj">CNPJ</label>
                                <input type="text" id="editCnpj" name="cnpj" class="form-input cnpj-mask">
                            </div>
                            
                            <div class="form-group">
                                <label for="editSize">Porte da Empresa</label>
                                <select id="editSize" name="size" class="form-select">
                                    <option value="">Selecione o porte</option>
                                    <option value="micro">Microempresa</option>
                                    <option value="small">Pequena</option>
                                    <option value="medium">Média</option>
                                    <option value="large">Grande</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Localização -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="map-pin" class="section-icon"></i>
                            Localização
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="editState">Estado *</label>
                                <select id="editState" name="state" required class="form-select">
                                    <option value="">Carregando estados...</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editCity">Cidade *</label>
                                <select id="editCity" name="city" required class="form-select">
                                    <option value="">Selecione primeiro o estado</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editMicroregion">Microrregião</label>
                                <select id="editMicroregion" name="microregion" class="form-select">
                                    <option value="">Selecione a microrregião</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editAddress">Endereço Completo</label>
                                <input type="text" id="editAddress" name="address" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Contato -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="phone" class="section-icon"></i>
                            Informações de Contato
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="editPhone">Telefone Principal *</label>
                                <input type="tel" id="editPhone" name="phone" required class="form-input phone-mask">
                            </div>
                            
                            <div class="form-group">
                                <label for="editSecondaryPhone">Telefone Secundário</label>
                                <input type="tel" id="editSecondaryPhone" name="secondaryPhone" class="form-input phone-mask">
                            </div>
                            
                            <div class="form-group">
                                <label for="editEmail">Email</label>
                                <input type="email" id="editEmail" name="email" class="form-input">
                            </div>
                            
                            <div class="form-group">
                                <label for="editWebsite">Website</label>
                                <input type="url" id="editWebsite" name="website" class="form-input">
                            </div>
                        </div>
                    </div>

                    <!-- Informações Adicionais -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="info" class="section-icon"></i>
                            Informações Adicionais
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="editStudents">Número de Alunos</label>
                                <input type="number" id="editStudents" name="students" min="0" class="form-input">
                            </div>
                            
                            <div class="form-group">
                                <label for="editFoundedYear">Ano de Fundação</label>
                                <input type="number" id="editFoundedYear" name="foundedYear" min="1800" max="2025" class="form-input">
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="editNotes">Observações</label>
                                <textarea id="editNotes" name="notes" rows="3" class="form-textarea" placeholder="Observações adicionais sobre o cliente..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Status e Responsável -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="settings" class="section-icon"></i>
                            Status e Responsável
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="editStatus">Status</label>
                                <select id="editStatus" name="status" class="form-select">
                                    <option value="active">Ativo</option>
                                    <option value="inactive">Inativo</option>
                                    <option value="prospect">Prospect</option>
                                    <option value="negotiation">Em Negociação</option>
                                    <option value="closed">Fechado</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editResponsible">Responsável</label>
                                <select id="editResponsible" name="responsible" class="form-select">
                                    <option value="">Selecione o responsável</option>
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editPriority">Prioridade</label>
                                <select id="editPriority" name="priority" class="form-select">
                                    <option value="low">Baixa</option>
                                    <option value="medium">Média</option>
                                    <option value="high">Alta</option>
                                    <option value="urgent">Urgente</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editLastContact">Último Contato</label>
                                <input type="date" id="editLastContact" name="lastContact" class="form-input">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer edit-modal-footer">
                <div class="form-info">
                    <span class="required-info">* Campos obrigatórios</span>
                </div>
                <div class="form-actions">
                    <button type="button" id="cancelEdit" class="cancel-button">
                        <i data-lucide="x" class="button-icon"></i>
                        Cancelar
                    </button>
                    <button type="button" id="saveChanges" class="save-button">
                        <i data-lucide="save" class="button-icon"></i>
                        Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Modal de Novo Envio (Bulk Send) -->
    <div id="bulkSendModal" class="bulk-send-modal">
        <div class="bulk-send-modal-backdrop"></div>
        <div class="bulk-send-modal-content">
            <div class="bulk-send-modal-header">
                <h2>Novo Envio em Massa</h2>
                <button id="closeBulkSendModal" class="bulk-send-close-btn">
                    <i data-lucide="x"></i>
                </button>
            </div>

            <!-- Wizard Steps -->
            <div class="bulk-send-modal-body">
                <div class="wizard-steps">
                    <div class="wizard-step active" data-step="1">
                        <div class="wizard-step-number">1</div>
                        <div class="wizard-step-label">Tipo de Envio</div>
                    </div>
                    <div class="wizard-step" data-step="2">
                        <div class="wizard-step-number">2</div>
                        <div class="wizard-step-label">Selecionar Contatos</div>
                    </div>
                    <div class="wizard-step" data-step="3">
                        <div class="wizard-step-number">3</div>
                        <div class="wizard-step-label">Confirmar e Enviar</div>
                    </div>
                </div>

                <!-- Step 1: Escolher tipo de envio -->
                <div id="wizardStep1" class="wizard-step-content">
                    <h3 style="margin-bottom: 1.5rem; font-size: 1.1rem; color: #1f2937;">Escolha o tipo de envio:</h3>
                    <div class="send-type-options">
                        <div class="send-type-card whatsapp" data-type="whatsapp">
                            <div class="send-type-icon">
                                <i data-lucide="message-circle"></i>
                            </div>
                            <div class="send-type-title">WhatsApp</div>
                            <div class="send-type-description">Enviar mensagem via WhatsApp</div>
                        </div>
                        <div class="send-type-card email" data-type="email">
                            <div class="send-type-icon">
                                <i data-lucide="mail"></i>
                            </div>
                            <div class="send-type-title">E-mail</div>
                            <div class="send-type-description">Enviar e-mail para contatos</div>
                        </div>
                        <div class="send-type-card document" data-type="document">
                            <div class="send-type-icon">
                                <i data-lucide="file-text"></i>
                            </div>
                            <div class="send-type-title">Documento</div>
                            <div class="send-type-description">Enviar documento ou arquivo</div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Selecionar contatos -->
                <div id="wizardStep2" class="wizard-step-content" style="display: none;">
                    <h3 style="margin-bottom: 1rem; font-size: 1.1rem; color: #1f2937;">Selecione os destinatários:</h3>
                    <div class="select-all-contacts">
                        <input type="checkbox" id="selectAllWizard">
                        <span>Selecionar todos os contatos</span>
                    </div>
                    <div class="contacts-list" id="contactsList">
                        <!-- Contatos serão preenchidos dinamicamente -->
                    </div>
                </div>

                <!-- Step 3: Confirmar e enviar -->
                <div id="wizardStep3" class="wizard-step-content" style="display: none;">
                    <h3 style="margin-bottom: 1.5rem; font-size: 1.1rem; color: #1f2937;">Confirme os dados do envio:</h3>
                    <div class="send-summary">
                        <div class="summary-item">
                            <span class="summary-label">Tipo de Envio:</span>
                            <span class="summary-value" id="summaryType">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Destinatários:</span>
                            <span class="summary-value" id="summaryRecipients">0 selecionados</span>
                        </div>
                    </div>

                    <!-- Área de mensagem (WhatsApp/Email) -->
                    <div id="bulkTemplateRow" style="display:none; margin: 1rem 0; display:flex; gap:.5rem; align-items:center;">
                        <label style="font-weight:600;">Modelo:</label>
                        <select id="bulkTemplateSelect" style="flex:1; padding:0.5rem; border:1px solid #e5e7eb; border-radius:8px;"></select>
                        <button id="applyBulkTemplateBtn" class="wizard-btn" style="gap:.5rem;">
                            <i data-lucide="wand-2" style="width:18px;height:18px;"></i>
                            Aplicar
                        </button>
                    </div>
                    <div id="messageInputArea" class="message-input-area" style="display: none;">
                        <div id="bulkEmailSubjectRow" style="display:none; margin-bottom: 0.75rem;">
                            <label for="bulkEmailSubject" style="display:block; font-weight: 600; margin-bottom: 0.5rem;">Assunto (e-mail):</label>
                            <input type="text" id="bulkEmailSubject" style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 8px;" placeholder="Assunto do e-mail">
                        </div>
                        <label for="bulkMessageText">Mensagem:</label>
                        <textarea id="bulkMessageText" placeholder="Digite sua mensagem aqui..."></textarea>
                        <div id="bulkEmailAttachmentRow" style="display:none; margin-top: 0.75rem;">
                            <label style="display:block; font-weight: 600; margin-bottom: 0.5rem;">Anexos (opcional):</label>
                            <input type="file" id="bulkEmailAttachments" multiple>
                        </div>
                    </div>

                    <!-- Área de upload (Documento) -->
                    <div id="fileUploadArea" class="file-upload-area" style="display: none;">
                        <label>Anexar Documento:</label>
                        <div class="file-upload-box" id="fileUploadBox">
                            <input type="file" id="bulkFileInput" accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg">
                            <div class="file-upload-icon">
                                <i data-lucide="upload"></i>
                            </div>
                            <div class="file-upload-text">Clique ou arraste um arquivo aqui</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bulk-send-modal-footer">
                <button id="wizardBackBtn" class="wizard-btn wizard-btn-back" style="display: none;">
                    <i data-lucide="chevron-left"></i>
                    <span>Voltar</span>
                </button>
                <div style="flex: 1;"></div>
                <button id="wizardNextBtn" class="wizard-btn wizard-btn-next">
                    <span>Próximo</span>
                    <i data-lucide="chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Envio Rápido - WhatsApp -->
    <div id="quickWhatsAppModal" class="quick-send-modal whatsapp">
        <div class="bulk-send-modal-backdrop"></div>
        <div class="quick-send-modal-content">
            <div class="quick-send-header">
                <div class="quick-send-header-icon">
                    <i data-lucide="message-circle"></i>
                </div>
                <div class="quick-send-title">
                    <h3>Enviar WhatsApp</h3>
                    <p id="whatsappClientName">Cliente</p>
                </div>
                <button class="bulk-send-close-btn" id="closeWhatsAppModal">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="quick-send-body">
                <div style="margin-bottom: 1rem; display:flex; gap:.5rem; align-items:center;">
                    <label style="font-weight:600;">Modelo:</label>
                    <select id="quickWhatsAppTemplate" style="flex:1; padding:0.5rem; border:1px solid #e5e7eb; border-radius:8px;"></select>
                    <button id="applyWhatsAppTemplate" class="quick-send-btn" style="background:#eef2ff; color:#374151;">Aplicar</button>
                </div>
                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Mensagem:</label>
                <textarea id="quickWhatsAppMessage" style="width: 100%; min-height: 120px; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 8px; font-family: inherit;" placeholder="Digite sua mensagem..."></textarea>
            </div>
            <div class="quick-send-footer">
                <button class="quick-send-btn quick-send-btn-cancel" id="cancelWhatsAppSend">Cancelar</button>
                <button class="quick-send-btn quick-send-btn-send" id="confirmWhatsAppSend">
                    <i data-lucide="send" style="width: 18px; height: 18px;"></i>
                    Enviar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Envio Rápido - E-mail -->
    <div id="quickEmailModal" class="quick-send-modal email">
        <div class="bulk-send-modal-backdrop"></div>
        <div class="quick-send-modal-content">
            <div class="quick-send-header">
                <div class="quick-send-header-icon">
                    <i data-lucide="mail"></i>
                </div>
                <div class="quick-send-title">
                    <h3>Enviar E-mail</h3>
                    <p id="emailClientName">Cliente</p>
                </div>
                <button class="bulk-send-close-btn" id="closeEmailModal">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="quick-send-body">
                <div style="margin-bottom: 1rem; display:flex; gap:.5rem; align-items:center;">
                    <label style="font-weight:600;">Modelo:</label>
                    <select id="quickEmailTemplate" style="flex:1; padding:0.5rem; border:1px solid #e5e7eb; border-radius:8px;"></select>
                    <button id="applyEmailTemplate" class="quick-send-btn" style="background:#eef2ff; color:#374151;">Aplicar</button>
                </div>
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Assunto:</label>
                    <input type="text" id="quickEmailSubject" style="width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 8px;" placeholder="Assunto do e-mail">
                </div>
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Mensagem:</label>
                    <textarea id="quickEmailMessage" style="width: 100%; min-height: 120px; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 8px; font-family: inherit;" placeholder="Digite sua mensagem..."></textarea>
                </div>
                <div style="margin-top:1rem;">
                    <label style="display:block; font-weight: 600; margin-bottom: 0.5rem;">Anexo (opcional):</label>
                    <input type="file" id="quickEmailAttachment" multiple>
                </div>
            </div>
            <div class="quick-send-footer">
                <button class="quick-send-btn quick-send-btn-cancel" id="cancelEmailSend">Cancelar</button>
                <button class="quick-send-btn quick-send-btn-send" id="confirmEmailSend">
                    <i data-lucide="send" style="width: 18px; height: 18px;"></i>
                    Enviar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Envio Rápido - Documento -->
    <div id="quickDocumentModal" class="quick-send-modal document">
        <div class="bulk-send-modal-backdrop"></div>
        <div class="quick-send-modal-content">
            <div class="quick-send-header">
                <div class="quick-send-header-icon">
                    <i data-lucide="file-text"></i>
                </div>
                <div class="quick-send-title">
                    <h3>Enviar Documento</h3>
                    <p id="documentClientName">Cliente</p>
                </div>
                <button class="bulk-send-close-btn" id="closeDocumentModal">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="quick-send-body">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Documento:</label>
                    <div class="file-upload-box" style="padding: 1.5rem;">
                        <input type="file" id="quickDocumentFile" accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg">
                        <div class="file-upload-icon" style="margin-bottom: 0.5rem;">
                            <i data-lucide="upload"></i>
                        </div>
                        <div class="file-upload-text">Clique para selecionar arquivo</div>
                    </div>
                </div>
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Mensagem (opcional):</label>
                    <textarea id="quickDocumentMessage" style="width: 100%; min-height: 80px; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 8px; font-family: inherit;" placeholder="Adicione uma mensagem..."></textarea>
                </div>
            </div>
            <div class="quick-send-footer">
                <button class="quick-send-btn quick-send-btn-cancel" id="cancelDocumentSend">Cancelar</button>
                <button class="quick-send-btn quick-send-btn-send" id="confirmDocumentSend">
                    <i data-lucide="send" style="width: 18px; height: 18px;"></i>
                    Enviar
                </button>
            </div>
        </div>
    </div>

    <!-- Botão Flutuante para Mobile (quando há selecionados) -->
    <button id="bulkSendFloatingBtn" class="bulk-send-floating-btn">
        <i data-lucide="send"></i>
        <span>Enviar para <span class="selected-count-badge" id="selectedCountBadge">0</span></span>
    </button>

    <!-- Scripts -->
    <script src="auth-manager.js"></script>
    <script src="ibge-api.js"></script>
    <script src="api-client.js"></script>
    <script src="templates.js"></script>
    <script src="app-manager.js"></script>
    <script src="edit-modal.js"></script>
    <script src="bulk-send.js"></script>
    <script src="script.js"></script>
    <script>
        // Navegação para Pesquisar Contratos
        document.getElementById('searchContractsButton')?.addEventListener('click', () => {
            window.location.href = 'search.html';
        });
    </script>
</body>
</html>